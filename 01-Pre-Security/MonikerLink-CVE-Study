CVE-2024-21413 – Microsoft Outlook RCE

Platform: Self-study / TryHackMe
Category: Exploitation Basics – Email Security
CVE: CVE-2024-21413
Status: Completed ✅
---

#Objective

Understand CVE-2024-21413, how it is exploited through Outlook emails, and how both 
attackers and defenders interact with this vulnerability.
---

#Vulnerability Overview

CVE-2024-21413 is a critical Outlook vulnerability related to improper handling of MonikerLink objects.
Highlights:
-Exploitable via malicious email
-No user click required (Preview Pane)
-Triggers NTLM authentication
-Leads to hash leakage or RCE
---

#Exploitation(THM Lab Rev)

Attack Flow:
Attacker sends crafted email with UNC path
-Outlook processes the email automatically
-NTLM authentication is triggered
-Attacker captures or relays credentials

Common Tools:
-Responder
-ntlmrelayx
-Impacket

Impact:
-NTLM hash disclosure
-Credential relay
-Lateral movement
-Potential domain compromise
---

#Mitigation(YARA Ex)

rule CVE_2024_21413_Outlook_MonikerLink
{
    strings:
        $unc = "\\\\"
        $file = "file://"
        $moniker = "moniker"
    condition:
        any of them
}

---

#Pen-tester POV

-High‑value initial access vector
-No user interaction
-Effective in enterprise AD environments
-Useful for red team email scenarios

---

#Deffender-Apply-list

✔Patch Microsoft Outlook
✔ Block outbound SMB (445)
✔ Disable NTLM where possible
✔ Monitor suspicious email content
✔ Use EDR & email security rules

---

#Key Takeaways

-Email preview can trigger attacks
-Outlook is a critical attack surface
-NTLM remains a major weakness

---

#Proof
https://tryhackme.com/room/monikerlink?utm_campaign=social_share&utm_medium=social&utm_content=room&utm_source=copy&sharerId=6945499f39cd36bec0409d7e
